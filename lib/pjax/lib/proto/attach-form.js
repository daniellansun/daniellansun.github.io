var on=require("../events/on");var clone=require("../util/clone");var attrState="data-pjax-state";var formAction=function(e,t){if(isDefaultPrevented(t)){return}var r=clone(this.options);r.requestOptions={requestUrl:e.getAttribute("action")||window.location.href,requestMethod:e.getAttribute("method")||"GET"};var o=document.createElement("a");o.setAttribute("href",r.requestOptions.requestUrl);var a=checkIfShouldAbort(o,r);if(a){e.setAttribute(attrState,a);return}t.preventDefault();if(e.enctype==="multipart/form-data"){r.requestOptions.formData=new FormData(e)}else{r.requestOptions.requestParams=parseFormElements(e)}e.setAttribute(attrState,"submit");r.triggerElement=e;this.loadUrl(o.href,r)};function parseFormElements(e){var t=[];var r=e.elements;for(var o=0;o<r.length;o++){var a=r[o];var n=a.tagName.toLowerCase();if(!!a.name&&a.attributes!==undefined&&n!=="button"){var i=a.attributes.type;if(!i||i.value!=="checkbox"&&i.value!=="radio"||a.checked){var u=[];if(n==="select"){var l;for(var s=0;s<a.options.length;s++){l=a.options[s];if(l.selected&&!l.disabled){u.push(l.hasAttribute("value")?l.value:l.text)}}}else{u.push(a.value)}for(var c=0;c<u.length;c++){t.push({name:encodeURIComponent(a.name),value:encodeURIComponent(u[c])})}}}}return t}function checkIfShouldAbort(e,t){if(e.protocol!==window.location.protocol||e.host!==window.location.host){return"external"}if(e.hash&&e.href.replace(e.hash,"")===window.location.href.replace(location.hash,"")){return"anchor"}if(e.href===window.location.href.split("#")[0]+"#"){return"anchor-empty"}if(t.currentUrlFullReload&&e.href===window.location.href.split("#")[0]){return"reload"}}var isDefaultPrevented=function(e){return e.defaultPrevented||e.returnValue===false};module.exports=function(e){var t=this;e.setAttribute(attrState,"");on(e,"submit",(function(r){formAction.call(t,e,r)}))};